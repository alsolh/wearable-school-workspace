//var buff = new Buffer('82:7e:0c:c3:30:c0:19:00:14:61:73:73:65:73:73:6d:65:6e:74:73:2f:73:74:75:64:65:6e:74:31:7b:22:63:6f:75:72:73:65:57:6f:72:6b:22:3a:5b:7b:22:63:6f:75:72:73:65:49:64:22:3a:22:31:30:31:37:31:32:34:37:32:32:22:2c:22:69:64:22:3a:22:32:30:31:32:31:32:33:31:33:31:22:2c:22:74:69:74:6c:65:22:3a:22:54:69:6d:65:20:74:6f:20:45:69:66:66:65:6c:20:54:6f:77:65:72:22:2c:22:64:65:73:63:72:69:70:74:69:6f:6e:22:3a:7b:22:61:73:73:65:73:73:6d:65:6e:74:49:74:65:6d:22:3a:7b:22:69:64:65:6e:74:69:66:69:65:72:22:3a:22:67:70:73:31:22:2c:22:61:64:61:70:74:69:76:65:22:3a:22:66:61:6c:73:65:22:2c:22:74:69:6d:65:44:65:70:65:6e:64:65:6e:74:22:3a:22:66:61:6c:73:65:22:2c:22:63:6f:6e:74:65:78:74:22:3a:7b:22:73:65:6e:73:6f:72:4e:61:6d:65:73:22:3a:5b:22:47:50:53:22:5d:2c:22:65:6c:69:67:69:62:69:6c:69:74:79:22:3a:6e:75:6c:6c:7d:7d:2c:22:72:65:73:70:6f:6e:73:65:44:65:63:6c:61:72:61:74:69:6f:6e:22:3a:7b:22:69:64:65:6e:74:69:66:69:65:72:22:3a:22:52:45:53:50:4f:4e:53:45:22:2c:22:63:61:72:64:69:6e:61:6c:69:74:79:22:3a:22:73:69:6e:67:6c:65:22:2c:22:62:61:73:65:54:79:70:65:22:3a:22:69:64:65:6e:74:69:66:69:65:72:22:2c:22:63:6f:72:72:65:63:74:52:65:73:70:6f:6e:73:65:22:3a:32:7d:2c:22:6f:75:74:63:6f:6d:65:44:65:63:6c:61:72:61:74:69:6f:6e:22:3a:7b:22:69:64:65:6e:74:69:66:69:65:72:22:3a:22:53:43:4f:52:45:22:2c:22:63:61:72:64:69:6e:61:6c:69:74:79:22:3a:22:73:69:6e:67:6c:65:22:2c:22:62:61:73:65:54:79:70:65:22:3a:22:66:6c:6f:61:74:22:2c:22:64:65:66:61:75:6c:74:56:61:6c:75:65:22:3a:7b:22:76:61:6c:75:65:22:3a:22:30:2e:30:22:7d:7d:2c:22:69:74:65:6d:42:6f:64:79:22:3a:7b:22:70:22:3a:22:69:66:20:79:6f:75:20:61:72:65:20:69:6e:20:61:20:70:6c:61:6e:65:20:66:6c:79:69:6e:67:20:61:74:20:74:68:65:20:73:70:65:65:64:20:6f:66:20:35:30:30:20:4b:6d:20:70:65:72:20:68:6f:75:72:20:61:6e:64:20:74:68:65:20:45:69:66:66:65:6c:20:74:6f:77:65:72:20:69:73:20:63:75:72:72:65:6e:74:6c:79:20:37:38:35:35:2e:36:32:30:38:30:38:34:35:35:38:36:34:20:4b:6d:20:61:77:61:79:20:66:72:6f:6d:20:79:6f:75:2e:22:2c:22:76:61:72:69:61:62:6c:65:73:22:3a:5b:37:38:35:35:2e:36:32:30:38:30:38:34:35:35:38:36:34:5d:2c:22:63:68:6f:69:63:65:49:6e:74:65:72:61:63:74:69:6f:6e:22:3a:7b:22:72:65:73:70:6f:6e:73:65:49:64:65:6e:74:69:66:69:65:72:22:3a:22:52:45:53:50:4f:4e:53:45:22:2c:22:73:68:75:66:66:6c:65:22:3a:22:74:72:75:65:22:2c:22:6d:61:78:43:68:6f:69:63:65:73:22:3a:22:31:22:2c:22:70:72:6f:6d:70:74:22:3a:22:68:6f:77:20:6c:6f:6e:67:20:77:69:6c:6c:20:69:74:20:74:61:6b:65:20:74:6f:20:72:65:61:63:68:20:74:68:65:72:65:20:69:6e:20:68:6f:75:72:73:20:74:69:6d:65:3f:22:7d:7d:2c:22:72:65:73:70:6f:6e:73:65:50:72:6f:63:65:73:73:69:6e:67:22:3a:7b:22:74:65:6d:70:6c:61:74:65:22:3a:22:68:74:74:70:3a:2f:2f:77:77:77:2e:69:6d:73:67:6c:6f:62:61:6c:2e:6f:72:67:2f:71:75:65:73:74:69:6f:6e:2f:71:74:69:5f:76:32:70:31:2f:72:70:74:65:6d:70:6c:61:74:65:73:2f:6d:61:74:63:68:5f:63:6f:72:72:65:63:74:22:7d:7d:2c:22:73:74:61:74:65:22:3a:22:50:55:42:4c:49:53:48:45:44:22:2c:22:61:6c:74:65:72:6e:61:74:65:4c:69:6e:6b:22:3a:22:68:74:74:70:3a:2f:2f:63:6c:61:73:73:72:6f:6f:6d:2e:67:6f:6f:67:6c:65:2e:63:6f:6d:2f:63:2f:4d:54:41:78:4e:7a:45:79:4e:44:63:79:4d:6c:70:61:2f:6d:63:2f:4d:6a:41:78:4d:6a:45:79:4d:7a:45:7a:4d:56:70:61:2f:64:65:74:61:69:6c:73:22:2c:22:63:72:65:61:74:69:6f:6e:54:69:6d:65:22:3a:22:32:30:31:37:2d:30:34:2d:32:37:54:31:36:3a:30:36:3a:34:33:2e:34:37:37:5a:22:2c:22:75:70:64:61:74:65:54:69:6d:65:22:3a:22:32:30:31:37:2d:30:39:2d:30:39:54:31:36:3a:35:37:3a:35:32:2e:34:36:30:5a:22:2c:22:6d:61:78:50:6f:69:6e:74:73:22:3a:31:30:30:2c:22:77:6f:72:6b:54:79:70:65:22:3a:22:4d:55:4c:54:49:50:4c:45:5f:43:48:4f:49:43:45:5f:51:55:45:53:54:49:4f:4e:22:2c:22:73:75:62:6d:69:73:73:69:6f:6e:4d:6f:64:69:66:69:63:61:74:69:6f:6e:4d:6f:64:65:22:3a:22:4d:4f:44:49:46:49:41:42:4c:45:5f:55:4e:54:49:4c:5f:54:55:52:4e:45:44:5f:49:4e:22:2c:22:6d:75:6c:74:69:70:6c:65:43:68:6f:69:63:65:51:75:65:73:74:69:6f:6e:22:3a:7b:22:63:68:6f:69:63:65:73:22:3a:5b:31:35:2e:37:31:31:32:34:31:36:31:36:39:31:31:37:32:38:2c:33:31:34:2e:32:32:34:38:33:32:33:33:38:32:33:34:35:33:2c:31:30:2e:34:37:34:31:36:31:30:37:37:39:34:31:31:35:33:2c:37:38:2e:35:35:36:32:30:38:30:38:34:35:35:38:36:33:5d:7d:2c:22:61:73:73:69:67:6e:65:65:4d:6f:64:65:22:3a:22:41:4c:4c:5f:53:54:55:44:45:4e:54:53:22:2c:22:63:72:65:61:74:6f:72:55:73:65:72:49:64:22:3a:22:31:30:34:30:37:36:38:35:35:37:30:37:37:30:32:31:33:37:32:39:35:22:7d:2c:7b:22:63:6f:75:72:73:65:49:64:22:3a:22:31:30:31:37');
//console.log(buff.toString('utf8'));

var fs = require('fs');
var obj = JSON.parse(fs.readFileSync('pcapjson2xlsx/watchwithdelay', 'utf8'));
for(var i = 0; i < obj.length; i++) {
    try{
    console.log(obj[i]._source.layers.mqtt['mqtt.msg']);
        console.log(obj[i]._source.layers.mqtt['mqtt.msg']);
        mqttMsg = JSON.parse(obj[i]._source.layers.mqtt['mqtt.msg']);
        console.log(mqttMsg[mqttMsg.length - 1]);
        console.log(mqttMsg[mqttMsg.length - 1].sessionId);
    }
    catch (e) {

    }
}
var Excel = require('exceljs');
var workbook = new Excel.Workbook();
workbook.creator = 'Me';
workbook.lastModifiedBy = 'Her';
workbook.created = new Date(1985, 8, 30);
workbook.modified = new Date();
workbook.lastPrinted = new Date(2016, 9, 27);
workbook.properties.date1904 = true;
var sheet = workbook.addWorksheet('My Sheet');
sheet.columns = [
    { header: 'Id', key: 'id', width: 10 },
    { header: 'Name', key: 'name', width: 32 },
    { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }
];
sheet.addRow({id: 1, name: 'John Doe', DOB: new Date()});
sheet.addRow({id: 2, name: 'Jane Doe', DOB: new Date(1965,1,7)});
workbook.xlsx.writeFile('pcapjson2xlsx/pcapjson2xlsx.xlsx')
    .then(function() {
        console.log('done');
    });